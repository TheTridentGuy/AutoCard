/**
 * name: fireworks-js
 * version: 2.5.1
 * author: Vitalij Ryndin (https://crashmax.ru)
 * homepage: https://fireworks.js.org
 * license MIT
 * Note:
 * Hacks for white fireworks and multiple seperate hue ranges:
 * Copyright (c) 2022 Aiden Bohlander.
 */
!function(t,i){"object"==typeof exports&&typeof module<"u"?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t=typeof globalThis<"u"?globalThis:t||self).Fireworks={})}(this,(function(t){"use strict";function i(t){return Math.abs(Math.floor(t))}function s(t,i){return Math.random()*(i-t)+t}function e(t,i){return Math.floor(s(t,i+1))}function n(t,i,s,e){const n=Math.pow;return Math.sqrt(n(t-s,2)+n(i-e,2))}function h(t,i,s=1){if(t>361||t<0)throw new Error(`Expected hue 0-361 range, got \`${t}\``);if(i>100||i<0)throw new Error(`Expected lightness 0-100 range, got \`${i}\``);if(s>1||s<0)throw new Error(`Expected alpha 0-1 range, got \`${s}\``);return`hsla(${t}, 100%, ${361==t?100:i}%, ${s})`}const o=t=>{if("object"==typeof t&&null!==t){if("function"==typeof Object.getPrototypeOf){const i=Object.getPrototypeOf(t);return i===Object.prototype||null===i}return"[object Object]"===Object.prototype.toString.call(t)}return!1},a=["__proto__","constructor","prototype"],r=(...t)=>t.reduce(((t,i)=>(Object.keys(i).forEach((s=>{a.includes(s)||(Array.isArray(t[s])&&Array.isArray(i[s])?t[s]=i[s]:o(t[s])&&o(i[s])?t[s]=r(t[s],i[s]):t[s]=i[s])})),t)),{});class c{x;y;ctx;hue;friction;gravity;flickering;lineWidth;explosionLength;angle;speed;brightness;coordinates=[];decay;alpha=1;constructor({x:t,y:i,ctx:n,hue:h,decay:o,gravity:a,friction:r,brightness:c,flickering:d,lineWidth:u,explosionLength:l}){for(this.x=t,this.y=i,this.ctx=n,this.hue=h,this.gravity=a,this.friction=r,this.flickering=d,this.lineWidth=u,this.explosionLength=l,this.angle=s(0,2*Math.PI),this.speed=e(1,10),this.brightness=e(c.min,c.max),this.decay=s(o.min,o.max);this.explosionLength--;)this.coordinates.push([t,i])}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.friction,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed+this.gravity,this.alpha-=this.decay,this.alpha<=this.decay&&t()}draw(){const t=this.coordinates.length-1;this.ctx.beginPath(),this.ctx.lineWidth=this.lineWidth,this.ctx.fillStyle=h(this.hue,this.brightness,this.alpha),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=h(this.hue,this.flickering?s(0,this.brightness):this.brightness,this.alpha),this.ctx.stroke()}}const d=new class{hue;rocketsPoint;opacity;acceleration;friction;gravity;particles;explosion;mouse;boundaries;sound;delay;brightness;decay;flickering;intensity;traceLength;traceSpeed;lineWidth;lineStyle;autoresize;constructor(){this.autoresize=!0,this.lineStyle="round",this.flickering=50,this.traceLength=3,this.traceSpeed=10,this.intensity=30,this.explosion=5,this.gravity=1.5,this.opacity=.5,this.particles=50,this.friction=.95,this.acceleration=1.05,this.hue={min:0,max:360},this.rocketsPoint={min:50,max:50},this.lineWidth={explosion:{min:1,max:3},trace:{min:1,max:2}},this.mouse={click:!1,move:!1,max:1},this.delay={min:30,max:60},this.brightness={min:50,max:80},this.decay={min:.015,max:.03},this.sound={enabled:!1,files:["explosion0.mp3","explosion1.mp3","explosion2.mp3"],volume:{min:4,max:8}},this.boundaries={height:0,width:0,x:50,y:50}}updateOptions(t){Object.assign(this,r(this,t))}};class u{constructor(t){this.canvas=t,this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.pointerMove=this.pointerMove.bind(this)}active=!1;x;y;subscribe(){this.canvas.addEventListener("pointerdown",this.pointerDown),this.canvas.addEventListener("pointerup",this.pointerUp),this.canvas.addEventListener("pointermove",this.pointerMove)}unsubscribe(){this.canvas.removeEventListener("pointerdown",this.pointerDown),this.canvas.removeEventListener("pointerup",this.pointerUp),this.canvas.removeEventListener("pointermove",this.pointerMove)}usePointer(t,i){(d.mouse.click||d.mouse.move)&&(this.x=t.pageX-this.canvas.offsetLeft,this.y=t.pageY-this.canvas.offsetTop,this.active=i)}pointerDown(t){this.usePointer(t,d.mouse.click)}pointerUp(t){this.usePointer(t,!1)}pointerMove(t){this.usePointer(t,this.active)}}class l{constructor(t){this.render=t}tick=0;rafId=0;fps=60;tolerance=.1;now;start(){this.now=performance.now();const t=1e3/this.fps,i=s=>{this.rafId=requestAnimationFrame(i);const e=s-this.now;e>=t-this.tolerance&&(this.render(),this.now=s-e%t,this.tick+=e*(d.intensity*Math.PI)/1e3)};this.rafId=requestAnimationFrame(i)}stop(){cancelAnimationFrame(this.rafId)}}class p{constructor(t){this.fireworks=t,this.handleResize=this.handleResize.bind(this)}subscribe(){d.autoresize&&window.addEventListener("resize",this.handleResize)}unsubscribe(){d.autoresize&&window.removeEventListener("resize",this.handleResize)}handleResize(){this.fireworks.updateSize()}}class x{sounds=[];audioContext;onInit=!1;constructor(){this.init()}init(){!this.onInit&&d.sound.enabled&&(this.onInit=!0,this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.loadSounds())}async loadSounds(){for(const t of d.sound.files){const i=await(await fetch(t)).arrayBuffer();this.audioContext.decodeAudioData(i).then((t=>{this.sounds.push(t)})).catch((t=>{throw t}))}}play(){if(d.sound.enabled&&this.sounds.length){const t=this.audioContext.createBufferSource(),i=this.sounds[e(0,this.sounds.length-1)],n=this.audioContext.createGain();t.buffer=i,n.gain.value=s(d.sound.volume.min/100,d.sound.volume.max/100),n.connect(this.audioContext.destination),t.connect(n),t.start(0)}else this.init()}}class g{x;y;sx;sy;dx;dy;ctx;hue;speed;acceleration;traceLength;totalDistance;angle;brightness;coordinates=[];currentDistance=0;constructor({x:t,y:i,dx:s,dy:h,ctx:o,hue:a,speed:r,traceLength:c,acceleration:d}){for(this.x=t,this.y=i,this.sx=t,this.sy=i,this.dx=s,this.dy=h,this.ctx=o,this.hue=a,this.speed=r,this.traceLength=c,this.acceleration=d,this.totalDistance=n(t,i,s,h),this.angle=Math.atan2(h-i,s-t),this.brightness=e(50,70);this.traceLength--;)this.coordinates.push([t,i])}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.acceleration;const i=Math.cos(this.angle)*this.speed,s=Math.sin(this.angle)*this.speed;this.currentDistance=n(this.sx,this.sy,this.x+i,this.y+s),this.currentDistance>=this.totalDistance?t(this.dx,this.dy,this.hue):(this.x+=i,this.y+=s)}draw(){const t=this.coordinates.length-1;this.ctx.beginPath(),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=h(this.hue,this.brightness),this.ctx.stroke()}}class f{target;container;canvas;ctx;width;height;sound;resize;mouse;traces=[];explosions=[];waitStopRaf;raf;running=!1;constructor(t,i={}){this.target=t,this.container=t,this.createCanvas(this.target),this.updateOptions(i),this.sound=new x,this.resize=new p(this),this.mouse=new u(this.canvas),this.raf=new l(this.render.bind(this))}get isRunning(){return this.running}get version(){return"2.5.1"}start(){this.running||(this.canvas.isConnected||this.createCanvas(this.target),this.running=!0,this.resize.subscribe(),this.mouse.subscribe(),this.raf.start())}stop(t=!1){!this.running||(this.running=!1,this.resize.unsubscribe(),this.mouse.unsubscribe(),this.raf.stop(),this.clear(),t&&this.canvas.remove())}async waitStop(t){if(this.running)return new Promise((i=>{this.waitStopRaf=()=>{!this.waitStopRaf||(requestAnimationFrame(this.waitStopRaf),!this.traces.length&&!this.explosions.length&&(this.waitStopRaf=null,this.stop(t),i()))},this.waitStopRaf()}))}pause(){this.running=!this.running,this.running?this.raf.start():this.raf.stop()}clear(){!this.ctx||(this.traces=[],this.explosions=[],this.ctx.clearRect(0,0,this.width,this.height))}updateOptions(t){d.updateOptions(t)}updateSize({width:t=this.container.clientWidth,height:i=this.container.clientHeight}={}){this.width=t,this.height=i,this.canvas.width=t,this.canvas.height=i,this.updateBoundaries({...d.boundaries,width:t,height:i})}updateBoundaries(t){this.updateOptions({boundaries:t})}createCanvas(t){t instanceof HTMLCanvasElement?(t.isConnected||document.body.append(t),this.canvas=t):(this.canvas=document.createElement("canvas"),this.container.append(this.canvas)),this.ctx=this.canvas.getContext("2d"),this.updateSize()}render(){!this.ctx||!this.running||(this.ctx.globalCompositeOperation="destination-out",this.ctx.fillStyle=`rgba(0, 0, 0, ${d.opacity})`,this.ctx.fillRect(0,0,this.width,this.height),this.ctx.globalCompositeOperation="lighter",this.ctx.lineCap=d.lineStyle,this.ctx.lineJoin="round",this.initTrace(),this.drawTrace(),this.drawExplosion())}initTrace(){if(this.waitStopRaf)return;const{hue:t,delay:s,rocketsPoint:n,boundaries:h,traceLength:o,traceSpeed:a,acceleration:r,mouse:c}=d;var u,l;(this.raf.tick>e(s.min,s.max)||this.mouse.active&&c.max>this.traces.length)&&(this.traces.push(new g({x:this.width*e(n.min,n.max)/100,y:this.height,dx:this.mouse.x&&c.move||this.mouse.active?this.mouse.x:e(h.x,h.width-2*h.x),dy:this.mouse.y&&c.move||this.mouse.active?this.mouse.y:e(h.y,.5*h.height),ctx:this.ctx,hue:(u=t.list,l=e(0,u.length-1),e(u[l][0],u[l][1])),speed:a,acceleration:r,traceLength:i(o)})),this.raf.tick=0)}drawTrace(){this.ctx.lineWidth=s(d.lineWidth.trace.min,d.lineWidth.trace.max);let t=this.traces.length;for(;t--;)this.traces[t].draw(),this.traces[t].update(((i,s,e)=>{this.initExplosion(i,s,e),this.sound.play(),this.traces.splice(t,1)}))}initExplosion(t,n,h){const{particles:o,flickering:a,lineWidth:r,explosion:u,brightness:l,friction:p,gravity:x,decay:g}=d;let f=i(o);for(;f--;)this.explosions.push(new c({x:t,y:n,ctx:this.ctx,hue:h,friction:p,gravity:x,flickering:e(0,100)<=a,lineWidth:s(r.explosion.min,r.explosion.max),explosionLength:i(u),brightness:l,decay:g}))}drawExplosion(){let t=this.explosions.length;for(;t--;)this.explosions[t].draw(),this.explosions[t].update((()=>{this.explosions.splice(t,1)}))}}t.Fireworks=f,t.default=f,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));